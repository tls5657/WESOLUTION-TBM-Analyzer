# π€ TBM νμλ΅ μλ™ λ¶„μ„ λ¨λ“: κ°λ° μΌμ§€

λ³Έ λ¬Έμ„λ” `μ„μ†”λ£¨μ… μ•μ „κ΄€λ¦¬μ‹μ¤ν… κ³ λ„ν™” ν”„λ΅μ νΈ`μ μƒμ„Έν• κ°λ° κ³Όμ •μ„ κΈ°λ΅ν•©λ‹λ‹¤.

---

## π—“οΈ 1, 2μ£Όμ°¨ (7/2 ~ 7/11): STT λ¨λΈ κ°λ° λ° LLM μ—°λ™ κΈ°λ° κΈ°μ  κ²€μ¦

1μ£Όμ°¨μ—λ” ν”„λ΅μ νΈμ κΈ°μ μ  νƒ€λ‹Ήμ„±μ„ κ²€μ¦ν•κ³  ν•µμ‹¬ AI λ¨λΈμ„ κµ¬μ¶•ν•λ” λ° μ§‘μ¤‘ν–μµλ‹λ‹¤.

### Part 1. TBM νΉν™” μμ„±μΈμ‹(STT) λ¨λΈ κ°λ°

- **μ΄κΈ° λ‚κ΄€: κ³Όμ ν•©(Overfitting) λ¬Έμ  μ§λ©΄**
  - `Whisper-small` λ¨λΈμ„ μ†λ‰μ TBM λ°μ΄ν„°λ΅ μ§μ ‘ νμΈνλ‹ μ‹, λ¨λΈμ΄ ν›λ ¨ λ°μ΄ν„°λ§ μ•”κΈ°ν•μ—¬ μ²μ λ“£λ” μμ„±μ—λ” μλ―Έ μ—†λ” λ‹¨μ–΄λ¥Ό λ°λ³µν•λ” 'κ³ μ¥ ν„μƒ' λ°μƒ.
  - ![μ΄κΈ° νμΈνλ‹ ν›„ μ„±λ¥ μ§€ν‘](images/first_stt_metrics.png)
  - ![μ΄κΈ° νμΈνλ‹ λ¨λΈμ λ°λ³µ μ¤λ¥ μμ‹](images/stt_overfitting_error.png)

- **ν•΄κ²° κ³„ν: 3λ‹¨κ³„ μ μ§„μ  νμΈνλ‹ μ „λµ μλ¦½ λ° μ‹¤ν–‰**
  - **1λ‹¨κ³„ (μΌλ°ν™”):** AI-Hubμ 'μΌλ° νμ λ°μ΄ν„°'(15μ‹κ°„)λ΅ μ‚¬μ „ ν›λ ¨ν•μ—¬, λ¨λΈμ μΌλ°μ μΈ λ€ν™” μ΄ν•΄ λ¥λ ¥ ν™•λ³΄ (CER 50.4% λ‹¬μ„±).
  - **2λ‹¨κ³„ (μ „λ¬Έν™”):** 1λ‹¨κ³„ λ¨λΈμ„ 'μ‹¤μ  TBM λ°μ΄ν„°'(1μ‹κ°„)λ΅ ν›λ ¨μ‹μΌ, TBM μ „λ¬Έ μ©μ–΄ ν•™μµ.
  - **3λ‹¨κ³„ (κ°•μΈν™”):** λ°μ΄ν„° μ¦κ°•(Data Augmentation) κΈ°λ²•μ„ μ μ©ν• λ°μ΄ν„°λ΅ ν›λ ¨μ‹μΌ, ν„μ¥ μ†μ λ° λ‹¤μ–‘ν• λ°ν™” ν™κ²½μ— λ€ν• λ€μ‘ λ¥λ ¥ κ°•ν™”.

- **ν•΄κ²° μ„±κ³Ό: WER, CER μ μ λ€ν­ ν•ν–¥**
  - κ²€μ¦ λ°μ΄ν„°μ…‹ κΈ°μ¤€ **CER(κΈ€μ μ¤λ¥μ¨) 28.9%** λ‹¬μ„±.
  - ![3λ‹¨κ³„ νμΈνλ‹ ν›„ μ„±λ¥ μ§€ν‘](images/3_stt_metrics.png)

### Part 2. LLM κΈ°λ° μ •λ³΄ μ¶”μ¶ ν…μ¤νΈ

- **μ΄κΈ° λ‚κ΄€: 'Garbage In, Garbage Out' λ¬Έμ **
  - STT κ²°κ³Όλ¬Όμ— λ‚¨μ€ μ‘μ€ μ¤λ¥λ“¤λ΅ μΈν•΄, μ†ν• μ–Έμ–΄ λ¨λΈ(LLM)μ΄ λ¬Έλ§¥μ„ μ΄ν•΄ν•μ§€ λ»ν•κ³  κ΄€λ ¨ μ—†λ” λ‚΄μ©μ„ μ§€μ–΄λ‚΄λ” **ν™κ°(Hallucination)** ν„μƒ λ°μƒ.
- **ν•΄κ²° κ³„ν: κ³ λ„ν™”λ ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§ μ μ©**
  - λ¨λΈμ μ—­ν• μ„ λ…ν™•ν μ •μν•κ³ , 'μ‘μ—…-μ„ν—-λ€μ±…'μ κ΄€κ³„λ¥Ό ν•™μµμ‹ν‚¤λ©°, κµ¬μ²΄μ μΈ μ¶λ ¥ ν•μ‹μ„ μ κ³µν•λ” λ“± ν”„λ΅¬ν”„νΈλ¥Ό μ μ§„μ μΌλ΅ κ°μ„ .
  - ![ν”„λ΅¬ν”„νΈ κµ¬μ„±](images/prompt.png)
---

## π—“οΈ 3μ£Όμ°¨ (7/14 ~ 7/18): STT λ¨λΈ νμΈνλ‹ λ° κ³„ν μμ •

3μ£Όμ°¨μ—λ” STT λ¨λΈμ μ„±λ¥μ„ λ”μ± λμ–΄μ¬λ¦¬κΈ° μ„ν• μ¶”κ°€ νμΈνλ‹κ³Ό ν•¨κ», λ°μ΄ν„°μ…‹ μ „λµμ— λ€ν• κ³„ν μμ •.

### Part 1. STT λ¨λΈ μ¶”κ°€ νμΈνλ‹ λ° λ°μ΄ν„°μ…‹ μ „λµ μ¬μλ¦½

* **μ΄κΈ° λ‚κ΄€: λ¬Όλ¥ μ¤λ””μ¤ λ°μ΄ν„°μ λ„λ©”μΈ λ¶μΌμΉ**
    * 6μ‹κ°„ λ¶„λ‰μ λ¬Όλ¥ νμ‚¬ μ¤λ””μ¤ λ°μ΄ν„°μ…‹μ„ μ¶”κ°€ ν™•λ³΄ν•μ—¬ νμΈνλ‹ν–μΌλ‚, κ±΄μ„¤ λ„λ©”μΈκ³Όμ κ΄΄λ¦¬λ΅ μΈν•΄ μ¤νλ ¤ λ¨λΈ μ„±λ¥μ΄ μ €ν•λλ” λ¬Έμ  λ°μƒ.
* **κ²°λ΅ : λ°μ΄ν„°μ…‹ μ „λµ μμ •**
    * λ¬Όλ¥ λ°μ΄ν„°μ…‹μ€ κ³Όκ°ν•κ² νκΈ°ν•κ³ , **κ±΄μ„¤ λ„λ©”μΈ λ°μ΄ν„°μ—λ§ μ§‘μ¤‘**ν•λ” κ²ƒμΌλ΅ μ „λµμ„ μ¬μλ¦½ν–μµλ‹λ‹¤.

#### PEFT (LoRA) κΈ°λ° νμΈνλ‹ (1μ°¨)

AI-Hub λ°μ΄ν„°λ΅ μ‚¬μ „ ν›λ ¨λ λ¨λΈμ— 1μ‹κ°„ λ¶„λ‰μ κ±΄μ„¤ TBM λ°μ΄ν„°μ…‹μ„ PEFT(LoRA) κΈ°λ²•μΌλ΅ ν•™μµμ‹μΌ°μµλ‹λ‹¤.

<details>
<summary><strong>ν΄λ¦­ν•μ—¬ 1μ°¨ ν•μ΄νΌνλΌλ―Έν„° ν™•μΈ</strong></summary>

* **ν•™μµ νλΌλ―Έν„°**
    * `learning_rate`: 5e-6
    * `per_device_train_batch_size`: 12
    * `gradient_accumulation_steps`: 2
    * `num_train_epochs`: 10  
    * `lr_scheduler_type`: "cosine"
    * `warmup_steps`: 15
* **PEFT (LoRA) νλΌλ―Έν„°**
    * `r`: 32
    * `lora_alpha`: 64
    * `target_modules`: ["q_proj", "v_proj"]
    * `lora_dropout`: 0.2
</details>

* **μ„±κ³Ό:** 11λ²μ ν•μ΄νΌνλΌλ―Έν„° μμ •μ„ κ±°μ³ **CER 43%**λ¥Ό λ‹¬μ„±ν–μµλ‹λ‹¤.
* - ![PEFT1](images/peft1.png)

#### λ°μ΄ν„° μ¦κ°• λ° PEFT (LoRA) κΈ°λ° νμΈνλ‹ (2μ°¨)

μ„±λ¥ ν–¥μƒμ„ μ„ν•΄ μ¶”κ°€ λ°μ΄ν„°λ¥Ό μƒμ„±ν•κ³  2μ°¨ νμΈνλ‹μ„ μ§„ν–‰ν–μµλ‹λ‹¤.

* **λ°μ΄ν„° μ¶”κ°€ ν™•λ³΄:** `train` λ°μ΄ν„°μ…‹μ—μ„ μ¤λ¥μ¨(CER)μ΄ κ°€μ¥ λ†’μ€ 30κ° λ¬Έμ¥μ„ μ¶”μ¶ν•κ³ , TTS(Clova Dubbing) λ° TBM μμ‹λ¥Ό ν™μ©ν•μ—¬ 30λ¶„ λ¶„λ‰μ λ°μ΄ν„°μ…‹ μ¶”κ°€ ν™•λ³΄.
* **ν•μ΄νΌνλΌλ―Έν„° λ³€κ²½:** `lora_dropout`μ„ 0.3μΌλ΅ λ†’μ΄κ³ , `r`κ³Ό `lora_alpha`λ¥Ό κ°κ° 16, 32λ΅ μ΅°μ •ν•μ—¬ λ¨λΈμ λ³µμ΅λ„λ¥Ό λ‚®μ·„μµλ‹λ‹¤.

* **μ„±κ³Ό:** μ¶”κ°€ νμΈνλ‹ κ²°κ³Ό **CER 32%**λ¥Ό λ‹¬μ„±ν•λ©° λ¨λΈ μ„±λ¥μ„ μλ―Έ μκ² κ°μ„ ν–μµλ‹λ‹¤.
* - ![PEFT2](images/peft2.png)

### Part 2. ν•κµ­μ–΄ νΉν™” STT λ¨λΈ μ„μΉ­ μ‹μ‘

`Whisper` λ¨λΈμ κ·Όλ³Έμ μΈ ν•κ³„λ¥Ό λλΌκ³ , λ” λ‚μ€ μ„±λ¥μ„ μ„ν•΄ ν•κµ­μ–΄ λ°μ΄ν„°λ΅ μ‚¬μ „ ν•™μµλ λ¨λΈμ„ νƒμƒ‰ν•κΈ° μ‹μ‘ν–μµλ‹λ‹¤.

---

## π—“οΈ 4-5μ£Όμ°¨ (7/18 ~ 8/1): λ¨λΈ μµμΆ… μµμ ν™” λ° μ‹μ¤ν… ν†µν•©

ν”„λ΅μ νΈ ν›„λ°λ¶€μ—λ” μµμΆ… μ„±λ¥ λ©ν‘λ¥Ό λ‹¬μ„±ν•κΈ° μ„ν• λ¨λΈ μµμ ν™”μ™€ μ „μ²΄ μ‹μ¤ν…μ„ μ™„μ„±ν•λ” λ° μ§‘μ¤‘ν–μµλ‹λ‹¤.

### Part 1. ν•κµ­μ–΄ νΉν™” STT λ¨λΈ μ„ μ • λ° μµμΆ… μ„±λ¥ λ‹¬μ„±

* **λ² μ΄μ¤ λ¨λΈ μ„ μ •:** 3μ£Όμ°¨μ— μ‹μ‘ν• λ¦¬μ„μΉλ¥Ό ν†µν•΄ Hugging Faceμ λ‹¤μ–‘ν• ν•κµ­μ–΄ νΉν™” Whisper λ¨λΈλ“¤μ„ ν‰κ°€ν–μµλ‹λ‹¤. κ·Έμ¤‘ TBM λ°μ΄ν„°μ…‹μ—μ„ κ°€μ¥ λ‚®μ€ CER(32%)μ„ λ³΄μΈ **`seastar105/whisper-small-komixv2`** λ¨λΈμ„ μµμΆ… λ² μ΄μ¤ λ¨λΈλ΅ μ„ μ •ν–μµλ‹λ‹¤.
* **ν•μ΄νΌνλΌλ―Έν„° μµμ ν™”:** μ•½ 30νμ λ°λ³µμ μΈ μ‹¤ν—μ„ ν†µν•΄ ν•™μµλ¥ , λ°°μΉ ν¬κΈ° λ“± μµμ μ ν•μ΄νΌνλΌλ―Έν„°λ¥Ό μ°Ύμ•„λƒμµλ‹λ‹¤. ([PEFT.py](src/PEFT.py))
* **μµμΆ… μ„±κ³Ό: CER 17% λ‹¬μ„±**
    * μ§€μ†μ μΈ νλ‹μ„ ν†µν•΄ μµμΆ…μ μΌλ΅ **λ©ν‘μΉλ¥Ό λ›°μ–΄λ„λ” CER 17%**λΌλ” μ°μν• μ„±λ¥μ„ ν™•λ³΄ν–μµλ‹λ‹¤.

### Part 2. λ¨λΈ κ²½λ‰ν™” λ° LLM μ”μ•½ λ¨λ“ κµ¬μ¶•

* **STT λ¨λΈ μ–‘μν™”:** λ°°ν¬ ν¨μ¨μ„±μ„ μ„ν•΄ 4λΉ„νΈ μ–‘μν™”(4-bit Quantization)λ¥Ό μ μ©, κΈ°μ΅΄ **462MB**μ€λ λ¨λΈ ν¬κΈ°λ¥Ό **182MB**λ΅ νκΈ°μ μΌλ΅ μ¤„μ€μµλ‹λ‹¤.
* **μ”μ•½ LLM μ„ μ •:** ν•κµ­μ–΄ μ„±λ¥μ΄ λ›°μ–΄λ‚ SKTμ **`A.X 4.0 Light`** λ¨λΈ(3λΉ„νΈ μ–‘μν™” λ²„μ „)μ„ μ •λ³΄ μ¶”μ¶ λ° μ”μ•½ λ¨λ“λ΅ μ±„νƒν–μµλ‹λ‹¤.
* **μ‹μ¤ν… ν†µν•© λ° ν”„λ΅¬ν”„νΈ μ„¤κ³„:** κ°λ°λ STT λ¨λΈκ³Ό LLMμ„ ν†µν•©ν•μ—¬ μµμΆ… μ‹μ¤ν…μ„ κµ¬μ¶•ν–μµλ‹λ‹¤. LLMμ΄ "μ‘μ—…λ‚΄μ©", "μ μ¬μ„ν—μ”μΈ", "λ€μ±…"μ 3κ°€μ§€ ν•µμ‹¬ ν•­λ©μ„ μ •ν™•ν μ¶”μ¶ν•λ„λ΅ ν”„λ΅¬ν”„νΈλ¥Ό μ„¤κ³„ν–μµλ‹λ‹¤. ([final.py](src/final.py))

## π μµμΆ… μ‹μ¤ν… νμ΄ν”„λΌμΈ: κΈ΄ μ¤λ””μ¤ μ²λ¦¬ κ³Όμ •

κΈ΄ μ¤λ””μ¤ νμΌ(μ: κ±΄μ„¤ ν„μ¥ νμ λ…Ήμ·¨λ΅)μ„ ν†µμ§Έλ΅ AI λ¨λΈμ— μ…λ ¥ν•λ©΄ λ©”λ¨λ¦¬ λ¶€μ΅±, ν’μ§ μ €ν• λ“±μ λ¬Έμ κ°€ λ°μƒν•©λ‹λ‹¤. μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ μ•„λμ™€ κ°™μ€ μ•μ •μ μΈ μ²λ¦¬ νμ΄ν”„λΌμΈμ„ κµ¬μ¶•ν–μµλ‹λ‹¤.

**[κΈ΄ μ¤λ””μ¤ νμΌ] β” [1. μμ„±/μΉ¨λ¬µ λ¶„λ¦¬] β” [2. μμ„± κµ¬κ°„ λ¶„ν• ] β” [3. STT ν…μ¤νΈ λ³€ν™] β” [4. LLM κµμ • λ° μ”μ•½] β” [μµμΆ… λ³΄κ³ μ„]**

### 1λ‹¨κ³„: μμ„±/μΉ¨λ¬µ κµ¬κ°„ λ¶„λ¦¬ (VAD)

* **λ¬Έμ μ :** μ¤λ””μ¤ νμΌμ—λ” λ€ν™”κ°€ μ—†λ” κΈ΄ μΉ¨λ¬µ κµ¬κ°„μ΄ ν¬ν•¨λμ–΄ μμ–΄ λ¶ν•„μ”ν• μ²λ¦¬ μ‹κ°„μ„ μ λ°ν•©λ‹λ‹¤.
* **ν•΄κ²°μ±…:** **`Silero VAD`** λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ¤λ””μ¤μ—μ„ μ‹¤μ  μμ„±(λ§ν•λ” λ¶€λ¶„)λ§ μ •ν™•ν•κ² νƒμ§€ν•κ³ , λ¶ν•„μ”ν• μΉ¨λ¬µ κµ¬κ°„μ„ λ¨λ‘ μ κ±°ν•©λ‹λ‹¤.

### 2λ‹¨κ³„: μμ„± κµ¬κ°„ λ¶„ν•  (Audio Chunking)

* **λ¬Έμ μ :** μΉ¨λ¬µμ΄ μ κ±°λ μμ„± κµ¬κ°„μ΄λΌλ„ μ—¬μ „ν μ λ¶„ κΈΈμ΄λ΅ κΈΈ μ μμ–΄, Whisper λ¨λΈμ μ•μ •μ μΈ μ²λ¦¬λ¥Ό λ°©ν•΄ν•©λ‹λ‹¤.
* **ν•΄κ²°μ±…:** VADκ°€ νƒμ§€ν• μμ„± κµ¬κ°„μ„ Whisper λ¨λΈμ΄ μ²λ¦¬ν•κΈ° μ μ ν• κΈΈμ΄(μ: 25μ΄)μ **μ²­ν¬(Chunk)λ΅ λ‹¤μ‹ λ‚λ•λ‹λ‹¤.**
             μ΄ κ³Όμ •μ„ ν†µν•΄ μ•„λ¬΄λ¦¬ κΈ΄ μμ„±μ΄λΌλ„ μ•μ •μ μΌλ΅ μ²λ¦¬ν•  μ μμµλ‹λ‹¤.

### 3λ‹¨κ³„: ν…μ¤νΈ λ³€ν™ (STT)

* μ•μ„ μµμ ν™”ν• **ν•κµ­μ–΄ νΉν™” Whisper λ¨λΈ (CER 17%)**μ΄ λ¶„ν• λ μμ„± μ²­ν¬λ“¤μ„ μμ°¨μ μΌλ΅ μ²λ¦¬ν•μ—¬ ν…μ¤νΈλ΅ λ³€ν™ν•©λ‹λ‹¤.

### 4λ‹¨κ³„: ν…μ¤νΈ κµμ • λ° μ”μ•½ (LLM)

* **1μ°¨ κµμ • λ° μµμΆ… μ”μ•½:** **`Llama`**μ™€ κ°™μ€ κ³ μ„±λ¥ μ–Έμ–΄ λ¨λΈ(LLM)μ„ ν™μ©ν•©λ‹λ‹¤.
    1.  Whisperκ°€ λ³€ν™ν• μ „μ²΄ ν…μ¤νΈλ¥Ό μ…λ ¥λ°›μ•„ λ¬Έλ§¥μ— λ§κ² 1μ°¨λ΅ κµμ •ν•©λ‹λ‹¤.
    2.  κµμ •λ μ „μ²΄ ν…μ¤νΈλ¥Ό λ°”νƒ•μΌλ΅ **"μ‘μ—… λ‚΄μ©", "μ„ν— μ”μΈ", "μ•μ „ λ€μ±…"**μ ν•µμ‹¬ ν•­λ©μ„ μ¶”μ¶ν•μ—¬ μµμΆ… λ³΄κ³ μ„λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
* - ![final](images/final.png)
